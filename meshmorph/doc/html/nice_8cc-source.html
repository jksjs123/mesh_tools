<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>meshmorph: nice.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>nice.cc</h1><a href="nice_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="nice_8h.html">nice.h</a>"</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="box_8h.html">box.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "<a class="code" href="container_8h.html">container.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="face_8h.html">face.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="misc_8h.html">misc.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="object_8h.html">object.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include "<a class="code" href="space_8h.html">space.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include "<a class="code" href="vertex_8h.html">vertex.h</a>"</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">using</span> std::cout;
<a name="l00016"></a>00016 <span class="keyword">using</span> std::endl;
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <a class="code" href="classNice.html">Nice</a> * Nice::only_one = NULL;
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="classNice.html#0e7a8f2b7f6c9e5a41b4f0a106a7614e">00020</a> <a class="code" href="classNice.html">Nice</a> &amp; <a class="code" href="classNice.html#0e7a8f2b7f6c9e5a41b4f0a106a7614e">Nice::instance</a>()
<a name="l00021"></a>00021 {
<a name="l00022"></a>00022   <span class="comment">// Not thread-safe.</span>
<a name="l00023"></a>00023   <span class="comment">// -- lock mutex</span>
<a name="l00024"></a>00024   <span class="keywordflow">if</span> (only_one == NULL)
<a name="l00025"></a>00025     only_one = <span class="keyword">new</span> <a class="code" href="classNice.html">Nice</a>();
<a name="l00026"></a>00026   <span class="comment">// -- unlock mutex</span>
<a name="l00027"></a>00027   <span class="keywordflow">return</span> *only_one;
<a name="l00028"></a>00028 }
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 Nice::Nice (<span class="keyword">const</span> <a class="code" href="classNice.html">Nice</a> &amp; rhs)
<a name="l00031"></a>00031   :nice()
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033   cout &lt;&lt; <span class="stringliteral">"Copy constructor prohibited on instances of Nice class.\n"</span>;
<a name="l00034"></a>00034   cout &lt;&lt; <span class="stringliteral">"Nice "</span> &lt;&lt; rhs.<a class="code" href="classNice.html#c2d790b2e12bf478d31ebfda92f20bb3">nice</a>.size() &lt;&lt; endl;
<a name="l00035"></a>00035   exit(0);
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 Nice::Nice(<span class="keywordtype">void</span>)
<a name="l00039"></a>00039   :nice()
<a name="l00040"></a>00040 {
<a name="l00041"></a>00041 }
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <a class="code" href="classNice.html">Nice</a>&amp; Nice::operator= (<span class="keyword">const</span> <a class="code" href="classNice.html">Nice</a>&amp; rhs)
<a name="l00044"></a>00044 {
<a name="l00045"></a>00045   cout &lt;&lt; <span class="stringliteral">"Copy assignment operator prohibited on instances of Nice class.\n"</span>;
<a name="l00046"></a>00046   cout &lt;&lt; <span class="stringliteral">"Nice "</span> &lt;&lt; rhs.<a class="code" href="classNice.html#c2d790b2e12bf478d31ebfda92f20bb3">nice</a>.size() &lt;&lt; endl;
<a name="l00047"></a>00047   exit(0);
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classNice.html#63af897cc818697a97bc5710216be3b7">00050</a> <span class="keywordtype">bool</span> <a class="code" href="classNice.html#63af897cc818697a97bc5710216be3b7">Nice::vertexIsNice</a> (<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> vv)<span class="keyword"> const</span>
<a name="l00051"></a>00051 <span class="keyword"></span>{
<a name="l00052"></a>00052   <span class="keywordflow">return</span> nice.find(const_cast&lt;Vertex*&gt;(vv))==nice.end();        
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="classNice.html#7622a05d54f6c7b2c651695d0e84bce7">00055</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#7622a05d54f6c7b2c651695d0e84bce7">Nice::setVertexNiceVal</a> (<span class="keywordtype">int</span> newval,<a class="code" href="classVertex.html">Vertex</a> * <span class="keyword">const</span> vv)
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057   <span class="comment">// newval == 0, nice</span>
<a name="l00058"></a>00058   <span class="comment">// newval == 1, nonnice in different object</span>
<a name="l00059"></a>00059   <span class="comment">// newval == 2, nonnice in same object</span>
<a name="l00060"></a>00060   <span class="keywordflow">if</span> (newval==0)
<a name="l00061"></a>00061   {
<a name="l00062"></a>00062     <a class="code" href="meshmorph_8h.html#8bb21ea8b96f25d850160ffd28bea2bb">vhm_it</a> i = nice.find(vv);
<a name="l00063"></a>00063     <span class="keywordflow">if</span>(i!=nice.end())
<a name="l00064"></a>00064     {
<a name="l00065"></a>00065       nice.erase(i);
<a name="l00066"></a>00066     }
<a name="l00067"></a>00067   }
<a name="l00068"></a>00068   <span class="keywordflow">else</span>
<a name="l00069"></a>00069   {
<a name="l00070"></a>00070       nice[vv]=newval;
<a name="l00071"></a>00071   }
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="classNice.html#b4bb5fcc411699c7a0c937f912ba2cfc">00074</a> <span class="keywordtype">int</span> <a class="code" href="classNice.html#b4bb5fcc411699c7a0c937f912ba2cfc">Nice::getVertexNiceVal</a> (<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> vv)<span class="keyword"> const</span>
<a name="l00075"></a>00075 <span class="keyword"></span>{
<a name="l00076"></a>00076   <span class="keywordflow">if</span> (<a class="code" href="classNice.html#63af897cc818697a97bc5710216be3b7">vertexIsNice</a>(const_cast&lt;Vertex*&gt;(vv)))
<a name="l00077"></a>00077   {
<a name="l00078"></a>00078     <span class="keywordflow">return</span> 0;
<a name="l00079"></a>00079   }
<a name="l00080"></a>00080   <span class="keywordflow">else</span>
<a name="l00081"></a>00081   {
<a name="l00082"></a>00082      <a class="code" href="meshmorph_8h.html#37680d6b8f28499a1aee927e43cb33c1">vhm_cit</a> i = nice.find(const_cast&lt;Vertex*&gt;(vv));    
<a name="l00083"></a>00083      <span class="keywordflow">return</span> (*i).second;
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="classNice.html#dc23e2de2de6bcb3720007014e5c5125">00087</a> <span class="keywordtype">int</span> <a class="code" href="classNice.html#dc23e2de2de6bcb3720007014e5c5125">Nice::findExtraPoint</a> (<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> v,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> &amp; p,<span class="keywordtype">int</span> <span class="keyword">const</span> index)<span class="keyword"> const</span>
<a name="l00088"></a>00088 <span class="keyword"></span>{
<a name="l00089"></a>00089   <a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> origin,end;
<a name="l00090"></a>00090   <a class="code" href="classNice.html#0ee3dac4558ae253f888e3758ca7ef1d">getExtraRay</a>(v,origin,end,index); <span class="comment">// returns ray</span>
<a name="l00091"></a>00091   <span class="comment">// look for intersected faces along ray, i.e. between face centroid and RAY ORIGIN</span>
<a name="l00092"></a>00092   <a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> crossed_faces,unique_faces,edge_faces;
<a name="l00093"></a>00093   <a class="code" href="classNice.html#0565c5314ebb9a3f175fc3a91c5a68da">collectNiceFaces</a>(origin,end,unique_faces);
<a name="l00094"></a>00094   <a class="code" href="classNice.html#ef49455dc3544d86d7b73afe8e660586">findIntersectedFaces</a>(origin,end,unique_faces,crossed_faces,edge_faces);
<a name="l00095"></a>00095   sort(crossed_faces.begin(),crossed_faces.end());
<a name="l00096"></a>00096   <span class="comment">// look for adjacent face in crossed_faces</span>
<a name="l00097"></a>00097   std::pair&lt;fp_it,fp_it&gt; j;
<a name="l00098"></a>00098   j=equal_range(crossed_faces.begin(),crossed_faces.end(),v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index));
<a name="l00099"></a>00099   <span class="comment">// if found, then remove</span>
<a name="l00100"></a>00100   <span class="keywordflow">if</span>(j.first!=j.second){crossed_faces.erase(j.first);}
<a name="l00101"></a>00101   <span class="keywordflow">if</span>( (edge_faces.size()%2)==1 )
<a name="l00102"></a>00102   {
<a name="l00103"></a>00103     cout &lt;&lt; <span class="stringliteral">"\n\nError: how can # edge_faces be odd?\n"</span>
<a name="l00104"></a>00104           &lt;&lt; <span class="stringliteral">"Nice::findExtraPoint: "</span>
<a name="l00105"></a>00105           &lt;&lt; <span class="stringliteral">"current vertex:\n"</span>;
<a name="l00106"></a>00106     v-&gt;<a class="code" href="classVertex.html#ef328a4374db75403a25eb165c1b7066">print</a>(std::cout);
<a name="l00107"></a>00107     cout &lt;&lt; <span class="stringliteral">"Nice::findExtraPoint: edge_faces:\n"</span>;
<a name="l00108"></a>00108     <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> i=edge_faces.begin();i!=edge_faces.end();i++)
<a name="l00109"></a>00109     {
<a name="l00110"></a>00110       (*i)-&gt;print(std::cout);
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112     cout &lt;&lt; endl;
<a name="l00113"></a>00113     cout &lt;&lt; <span class="stringliteral">"Nice::findExtraPoint: crossed_faces:\n"</span>;
<a name="l00114"></a>00114     <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> i=crossed_faces.begin();i!=crossed_faces.end();i++)
<a name="l00115"></a>00115     {
<a name="l00116"></a>00116       (*i)-&gt;print(std::cout);
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118     cout &lt;&lt; endl;
<a name="l00119"></a>00119     exit(0);
<a name="l00120"></a>00120   }
<a name="l00121"></a>00121   <a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> tmp;
<a name="l00122"></a>00122   <a class="code" href="classNice.html#bb4911d8fc3c85395c8884ab16381b91">findOddMeshes</a>(crossed_faces,edge_faces,tmp);
<a name="l00123"></a>00123   p[0]=end[0];
<a name="l00124"></a>00124   p[1]=end[1];
<a name="l00125"></a>00125   p[2]=end[2];
<a name="l00126"></a>00126   <span class="keywordflow">if</span> (!tmp.empty())
<a name="l00127"></a>00127   {
<a name="l00128"></a>00128     std::pair&lt;op_it,op_it&gt; i;
<a name="l00129"></a>00129     i=equal_range(tmp.begin(),tmp.end(),v-&gt;<a class="code" href="classVertex.html#9f5e25fd8be3ea577b4fc36069e1179d">getObject</a>());
<a name="l00130"></a>00130     <span class="keywordflow">if</span>(i.first!=i.second)
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132       <span class="keywordflow">return</span> 0;
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134   }
<a name="l00135"></a>00135   <span class="keywordflow">return</span> 1;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classNice.html#7182baa27280717eaae32dc04543ad00">00138</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#7182baa27280717eaae32dc04543ad00">Nice::findNonniceVertices</a> (<span class="keywordtype">void</span>)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140   cout &lt;&lt; <span class="stringliteral">"Find nice vertices............................."</span>;
<a name="l00141"></a>00141   cout.flush();
<a name="l00142"></a>00142   <span class="keywordtype">int</span> k=1;
<a name="l00143"></a>00143   <span class="keywordtype">double</span> goal = 0.2;
<a name="l00144"></a>00144   printf(<span class="stringliteral">"0%%.."</span>);
<a name="l00145"></a>00145   fflush(stdout);
<a name="l00146"></a>00146   <span class="keywordtype">double</span> a = 1.0/<a class="code" href="classContainer.html#e4646d7b418a9b302db245f074ad8ec5">Container::instance</a>().<a class="code" href="classContainer.html#c3ac0ef8e13fb01215064cd9bd24ff85">o</a>.size();
<a name="l00147"></a>00147   <span class="comment">// for each object in container</span>
<a name="l00148"></a>00148   <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#ee98e25193e5b352ac2eefbd05ccde6a">o_it</a> i=<a class="code" href="classContainer.html#e4646d7b418a9b302db245f074ad8ec5">Container::instance</a>().o.begin();i!=<a class="code" href="classContainer.html#e4646d7b418a9b302db245f074ad8ec5">Container::instance</a>().<a class="code" href="classContainer.html#c3ac0ef8e13fb01215064cd9bd24ff85">o</a>.end();i++)
<a name="l00149"></a>00149   {
<a name="l00150"></a>00150     <span class="comment">// for each vertex in object</span>
<a name="l00151"></a>00151     <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#3263d78f676958dea30d353e47e8b889">v_it</a> j=i-&gt;v.begin();j!=i-&gt;v.end();j++)
<a name="l00152"></a>00152     {
<a name="l00153"></a>00153       <a class="code" href="classNice.html#cbba0af11271c50201e5d3fdd6c77df5">updateVertexNiceness</a>(&amp;(*j));
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155     <span class="comment">// track progress</span>
<a name="l00156"></a>00156     <span class="keywordtype">double</span> progress = static_cast&lt;double&gt;(k++)*a;
<a name="l00157"></a>00157     <span class="keywordflow">if</span>(progress&gt;goal)
<a name="l00158"></a>00158     {
<a name="l00159"></a>00159       printf(<span class="stringliteral">"%d%%.."</span>,static_cast&lt;int&gt;(goal*100));
<a name="l00160"></a>00160       fflush(stdout);
<a name="l00161"></a>00161       goal+=0.2;
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163   }
<a name="l00164"></a>00164   printf(<span class="stringliteral">"100%%.."</span>);
<a name="l00165"></a>00165   fflush(stdout);
<a name="l00166"></a>00166   cout &lt;&lt; <span class="stringliteral">"complete.\n"</span>;
<a name="l00167"></a>00167   cout.flush();
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="classNice.html#cbba0af11271c50201e5d3fdd6c77df5">00170</a> <span class="keywordtype">bool</span> <a class="code" href="classNice.html#cbba0af11271c50201e5d3fdd6c77df5">Nice::updateVertexNiceness</a> (<a class="code" href="classVertex.html">Vertex</a> * <span class="keyword">const</span> v)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172   <a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> crossed_objects;
<a name="l00173"></a>00173   <span class="comment">// collect objects inside which vertex lies</span>
<a name="l00174"></a>00174   <a class="code" href="classNice.html#c7a50229706cdea0d81cbc9216136e3f">collectCrossedObjects</a>(v,crossed_objects);
<a name="l00175"></a>00175   <span class="comment">// update niceness of vertex based on crossed_objects</span>
<a name="l00176"></a>00176   <span class="keywordflow">return</span> <a class="code" href="classNice.html#8bda94694b244b3f2c147cdcdc07fc11">setVertexNiceness</a>(v,crossed_objects);
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 
<a name="l00180"></a><a class="code" href="classNice.html#f07c6fb120f29edc68f4787a32f70e8a">00180</a> <span class="keywordtype">bool</span> <a class="code" href="classNice.html#f07c6fb120f29edc68f4787a32f70e8a">Nice::getPointOutsideObject</a>(<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> v,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> &amp; p,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp; crossed_objects)<span class="keyword"> const</span>
<a name="l00181"></a>00181 <span class="keyword"></span>{
<a name="l00182"></a>00182   <span class="comment">// find point, p, outside of current object</span>
<a name="l00183"></a>00183   <span class="keywordtype">int</span> index = 0;
<a name="l00184"></a>00184   <span class="keywordtype">bool</span> good = <span class="keyword">false</span>;
<a name="l00185"></a>00185   <span class="keywordflow">while</span>(good==<span class="keyword">false</span>)
<a name="l00186"></a>00186   {
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (index&gt;(v-&gt;<a class="code" href="classVertex.html#b01da7ba35653cce77dfd96d3ec04872">getNumAdjFaces</a>()-1))
<a name="l00188"></a>00188     {
<a name="l00189"></a>00189       cout &lt;&lt; <span class="stringliteral">"\n\nNice::collectCrossed: "</span>
<a name="l00190"></a>00190             &lt;&lt; <span class="stringliteral">"Intersected edge along path from p to ECP on every adjacent face.\n"</span>
<a name="l00191"></a>00191             &lt;&lt; <span class="stringliteral">"Warning! Setting undetermined vertex to 'nice'.\n"</span>;
<a name="l00192"></a>00192       v-&gt;<a class="code" href="classVertex.html#ef328a4374db75403a25eb165c1b7066">print</a>(std::cout);
<a name="l00193"></a>00193       crossed_objects.clear();
<a name="l00194"></a>00194       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196     <span class="keywordflow">while</span> (!<a class="code" href="classNice.html#dc23e2de2de6bcb3720007014e5c5125">findExtraPoint</a>(v,p,index))
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198       index++;
<a name="l00199"></a>00199       <span class="keywordflow">if</span> (index&gt;(v-&gt;<a class="code" href="classVertex.html#b01da7ba35653cce77dfd96d3ec04872">getNumAdjFaces</a>()-1))
<a name="l00200"></a>00200       {
<a name="l00201"></a>00201         cout &lt;&lt; <span class="stringliteral">"\n\nNice::collectCrossed: "</span>
<a name="l00202"></a>00202               &lt;&lt; <span class="stringliteral">"Failed to find valid extracellular point on any adjacent face.\n"</span>
<a name="l00203"></a>00203               &lt;&lt; <span class="stringliteral">"Warning! Setting undetermined vertex to 'nice'.\n"</span>;
<a name="l00204"></a>00204         v-&gt;<a class="code" href="classVertex.html#ef328a4374db75403a25eb165c1b7066">print</a>(std::cout);
<a name="l00205"></a>00205         crossed_objects.clear();
<a name="l00206"></a>00206         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00207"></a>00207       }
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209     <span class="comment">// grab intersected objects between p and RAY ORIGIN and return as ca</span>
<a name="l00210"></a>00210     <a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> origin,end;
<a name="l00211"></a>00211     origin.push_back(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(0));
<a name="l00212"></a>00212     origin.push_back(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(1));
<a name="l00213"></a>00213     origin.push_back(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(2));
<a name="l00214"></a>00214     end.push_back(p[0]);
<a name="l00215"></a>00215     end.push_back(p[1]);
<a name="l00216"></a>00216     end.push_back(p[2]);
<a name="l00217"></a>00217     good=<a class="code" href="classNice.html#3202e57deb5f208a7858a2dc21e43c4d">findCrossedObjects1</a>(origin,end,crossed_objects,v);
<a name="l00218"></a>00218     <span class="keywordflow">if</span>(good==<span class="keyword">false</span>){index++;}
<a name="l00219"></a>00219   }
<a name="l00220"></a>00220   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classNice.html#c7a50229706cdea0d81cbc9216136e3f">00223</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#c7a50229706cdea0d81cbc9216136e3f">Nice::collectCrossedObjects</a> (<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> v,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp; crossed_objects)<span class="keyword"> const</span>
<a name="l00224"></a>00224 <span class="keyword"></span>{
<a name="l00225"></a>00225   <a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> ca;
<a name="l00226"></a>00226   <a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> p(3,0);
<a name="l00227"></a>00227   <span class="comment">// find point, p, outside of current object</span>
<a name="l00228"></a>00228   <span class="comment">// and grab intersected objects between p and RAY ORIGIN</span>
<a name="l00229"></a>00229   <span class="comment">// and return as ca</span>
<a name="l00230"></a>00230   <span class="keywordflow">if</span>(<a class="code" href="classNice.html#f07c6fb120f29edc68f4787a32f70e8a">getPointOutsideObject</a>(v,p,ca)==<span class="keyword">true</span>) <span class="keywordflow">return</span>;
<a name="l00231"></a>00231   <span class="comment">// grab intersected objects along RAY as cb</span>
<a name="l00232"></a>00232   <a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> origin(3,0),end(3,0);
<a name="l00233"></a>00233   origin[0] = p[0];
<a name="l00234"></a>00234   origin[1] = p[1];
<a name="l00235"></a>00235   origin[2] = p[2];
<a name="l00236"></a>00236   end[0]    = p[0];
<a name="l00237"></a>00237   end[1]    = p[1];
<a name="l00238"></a>00238   end[2]    = p[2];
<a name="l00239"></a>00239   <span class="comment">// get all rays sorted from shortest to longest</span>
<a name="l00240"></a>00240   <span class="keywordtype">double</span> rays[6][3];
<a name="l00241"></a>00241   <a class="code" href="classNice.html#3f5a741196705ed9a6add051518fa372">findClosestAxis</a>(v,origin,rays); <span class="comment">// returns ray</span>
<a name="l00242"></a>00242   <span class="comment">// initialize axis selection index</span>
<a name="l00243"></a>00243   <span class="comment">// applies to list of distances to world boundary sorted shortest to longest</span>
<a name="l00244"></a>00244   <span class="comment">// 0 == shortest direction, i.e. zeroth element</span>
<a name="l00245"></a>00245   <span class="comment">// 1 == second shortest direction, i.e. first element</span>
<a name="l00246"></a>00246   <span class="comment">// ...</span>
<a name="l00247"></a>00247   <span class="comment">// 5 == longest direction, i.e. fifth element</span>
<a name="l00248"></a>00248   <span class="keywordtype">int</span> select=0;
<a name="l00249"></a>00249   <span class="keywordtype">bool</span> keep = <span class="keyword">false</span>;
<a name="l00250"></a>00250   <span class="comment">// while an axis needs to be found and select is less than max</span>
<a name="l00251"></a>00251   <span class="keywordflow">while</span>(keep==<span class="keyword">false</span> &amp;&amp; select&lt;6)
<a name="l00252"></a>00252   {
<a name="l00253"></a>00253     origin[0]=p[0];
<a name="l00254"></a>00254     origin[1]=p[1];
<a name="l00255"></a>00255     origin[2]=p[2];
<a name="l00256"></a>00256     end[0]=rays[select][0];
<a name="l00257"></a>00257     end[1]=rays[select][1];
<a name="l00258"></a>00258     end[2]=rays[select][2];
<a name="l00259"></a>00259     keep=<a class="code" href="classNice.html#429be11b18100852c7c6bbeffcb5e296">findCrossedObjects2</a>(origin,end,crossed_objects);
<a name="l00260"></a>00260     <span class="keywordflow">if</span>(keep==<span class="keyword">false</span>){select++;}
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262   <span class="keywordflow">if</span>(select==6)
<a name="l00263"></a>00263   {
<a name="l00264"></a>00264     cout &lt;&lt; <span class="stringliteral">"\n\nNice::collectCrossed: ERROR: All six principal coordinates"</span>
<a name="l00265"></a>00265           &lt;&lt; <span class="stringliteral">" resulted in face edge collisions.\n"</span>;
<a name="l00266"></a>00266     v-&gt;<a class="code" href="classVertex.html#ef328a4374db75403a25eb165c1b7066">print</a>(std::cout);
<a name="l00267"></a>00267     cout &lt;&lt; endl;
<a name="l00268"></a>00268     exit(0);
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270   <span class="comment">// merge ca elements into crossed_objects</span>
<a name="l00271"></a>00271   sort(crossed_objects.begin(),crossed_objects.end());
<a name="l00272"></a>00272   <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#0f1596befebd38f6b2fe4e7fa62849b9">op_it</a> i=ca.begin();i!=ca.end();i++)
<a name="l00273"></a>00273   {
<a name="l00274"></a>00274     std::pair&lt;op_it,op_it&gt; j;
<a name="l00275"></a>00275     j=equal_range(crossed_objects.begin(),crossed_objects.end(),*i);
<a name="l00276"></a>00276     <span class="comment">// if object in ca is found in crossed_objects</span>
<a name="l00277"></a>00277     <span class="comment">// then remove from crossed_objects</span>
<a name="l00278"></a>00278     <span class="keywordflow">if</span>(j.first!=j.second){crossed_objects.erase(j.first);}
<a name="l00279"></a>00279     <span class="comment">// else add it</span>
<a name="l00280"></a>00280     <span class="keywordflow">else</span>
<a name="l00281"></a>00281     {
<a name="l00282"></a>00282       crossed_objects.push_back(*i);
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284   }
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a><a class="code" href="classNice.html#8bda94694b244b3f2c147cdcdc07fc11">00287</a> <span class="keywordtype">bool</span> <a class="code" href="classNice.html#8bda94694b244b3f2c147cdcdc07fc11">Nice::setVertexNiceness</a> (<a class="code" href="classVertex.html">Vertex</a> * <span class="keyword">const</span> v,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;cb)
<a name="l00288"></a>00288 {
<a name="l00289"></a>00289   <span class="comment">// new_nice==0 means nice</span>
<a name="l00290"></a>00290   <span class="comment">// new_nice==1 means nonnice in different object</span>
<a name="l00291"></a>00291   <span class="comment">// new_nice==2 means nonnice in same object</span>
<a name="l00292"></a>00292   <span class="keywordtype">int</span> old_nice = <a class="code" href="classNice.html#b4bb5fcc411699c7a0c937f912ba2cfc">getVertexNiceVal</a>(v);
<a name="l00293"></a>00293   <span class="keywordtype">int</span> new_nice = 0;
<a name="l00294"></a>00294   <span class="comment">// if cb is not empty</span>
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (cb.empty()==<span class="keyword">false</span>)
<a name="l00296"></a>00296   {
<a name="l00297"></a>00297     <span class="comment">// vertex is not nice</span>
<a name="l00298"></a>00298     new_nice++;
<a name="l00299"></a>00299     <span class="comment">// if vertex is inside self object</span>
<a name="l00300"></a>00300     std::pair&lt;op_it,op_it&gt; i;
<a name="l00301"></a>00301     i=equal_range(cb.begin(),cb.end(),v-&gt;<a class="code" href="classVertex.html#9f5e25fd8be3ea577b4fc36069e1179d">getObject</a>());
<a name="l00302"></a>00302     <span class="keywordflow">if</span>(i.first!=i.second){new_nice++;}
<a name="l00303"></a>00303   }
<a name="l00304"></a>00304   <a class="code" href="classNice.html#7622a05d54f6c7b2c651695d0e84bce7">setVertexNiceVal</a>(new_nice,v);
<a name="l00305"></a>00305   <span class="comment">// if vertex niceness changes then return true, else return false</span>
<a name="l00306"></a>00306   <span class="keywordflow">return</span> old_nice!=new_nice;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="classNice.html#3f5a741196705ed9a6add051518fa372">00309</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#3f5a741196705ed9a6add051518fa372">Nice::findClosestAxis</a> (<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> v,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp;origin,<span class="keywordtype">double</span> rays[6][3])<span class="keyword"> const</span>
<a name="l00310"></a>00310 <span class="keyword"></span>{
<a name="l00311"></a>00311   <span class="comment">// map: (distance to world bounds)double-&gt;(direction code)int</span>
<a name="l00312"></a>00312   <a class="code" href="meshmorph_8h.html#46e67a5b2b27ca92380034a01621a943">map_di</a> dist;
<a name="l00313"></a>00313   dist.insert(std::make_pair(fabs(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(0)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(0)),0));
<a name="l00314"></a>00314   dist.insert(std::make_pair(fabs(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(0)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(1)),1));
<a name="l00315"></a>00315   dist.insert(std::make_pair(fabs(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(1)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(2)),2));
<a name="l00316"></a>00316   dist.insert(std::make_pair(fabs(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(1)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(3)),3));
<a name="l00317"></a>00317   dist.insert(std::make_pair(fabs(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(2)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(4)),4));
<a name="l00318"></a>00318   dist.insert(std::make_pair(fabs(v-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(2)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(5)),5));
<a name="l00319"></a>00319   <span class="keywordtype">int</span> j=0;
<a name="l00320"></a>00320   <span class="comment">// for each map element</span>
<a name="l00321"></a>00321   <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#fe054e51e1cda4bbd76b11ba48d2bd04">di_it</a> i=dist.begin();i!=dist.end();i++)
<a name="l00322"></a>00322   {
<a name="l00323"></a>00323     <span class="keywordtype">int</span> index=(*i).second;
<a name="l00324"></a>00324     if          (index==0)
<a name="l00325"></a>00325     {
<a name="l00326"></a>00326       rays[j][0] = origin[0]-2*(<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(1)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(0));   <span class="comment">// end x</span>
<a name="l00327"></a>00327       rays[j][1] = origin[1];                                                   <span class="comment">// end y</span>
<a name="l00328"></a>00328       rays[j][2] = origin[2];                                                   <span class="comment">// end z</span>
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index==1)
<a name="l00331"></a>00331     {
<a name="l00332"></a>00332       rays[j][0] = origin[0]+2*(<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(1)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(0));   <span class="comment">// end x</span>
<a name="l00333"></a>00333       rays[j][1] = origin[1];                                                   <span class="comment">// end y</span>
<a name="l00334"></a>00334       rays[j][2] = origin[2];                                                   <span class="comment">// end z</span>
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index==2)
<a name="l00337"></a>00337     {
<a name="l00338"></a>00338       rays[j][0] = origin[0];                                                   <span class="comment">// end x</span>
<a name="l00339"></a>00339       rays[j][1] = origin[1]-2*(<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(3)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(2));   <span class="comment">// end y</span>
<a name="l00340"></a>00340       rays[j][2] = origin[2];                                                   <span class="comment">// end z</span>
<a name="l00341"></a>00341     }
<a name="l00342"></a>00342     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index==3)
<a name="l00343"></a>00343     {
<a name="l00344"></a>00344       rays[j][0] = origin[0];                                                   <span class="comment">// end x</span>
<a name="l00345"></a>00345       rays[j][1] = origin[1]+2*(<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(3)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(2));   <span class="comment">// end y</span>
<a name="l00346"></a>00346       rays[j][2] = origin[2];                                                   <span class="comment">// end z</span>
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index==4)
<a name="l00349"></a>00349     {
<a name="l00350"></a>00350       rays[j][0] = origin[0];                                                   <span class="comment">// end x</span>
<a name="l00351"></a>00351       rays[j][1] = origin[1];                                                   <span class="comment">// end y</span>
<a name="l00352"></a>00352       rays[j][2] = origin[2]-2*(<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(5)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(4));   <span class="comment">// end z</span>
<a name="l00353"></a>00353     }
<a name="l00354"></a>00354     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index==5)
<a name="l00355"></a>00355     {
<a name="l00356"></a>00356       rays[j][0] = origin[0];                                                   <span class="comment">// end x</span>
<a name="l00357"></a>00357       rays[j][1] = origin[1];                                                   <span class="comment">// end y</span>
<a name="l00358"></a>00358       rays[j][2] = origin[2]+2*(<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(5)-<a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b652fb81b7f565fb981d3c0fc4e235d6">getWorld</a>(4));   <span class="comment">// end z</span>
<a name="l00359"></a>00359     }
<a name="l00360"></a>00360     j++;
<a name="l00361"></a>00361   }
<a name="l00362"></a>00362 }       
<a name="l00363"></a>00363 
<a name="l00364"></a><a class="code" href="classNice.html#3202e57deb5f208a7858a2dc21e43c4d">00364</a> <span class="keywordtype">bool</span> <a class="code" href="classNice.html#3202e57deb5f208a7858a2dc21e43c4d">Nice::findCrossedObjects1</a> (<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; origin,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; end,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;c,<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> v)<span class="keyword"> const</span>
<a name="l00365"></a>00365 <span class="keyword"></span>{
<a name="l00366"></a>00366   <span class="comment">// find and return crossed objects between origin point and end point</span>
<a name="l00367"></a>00367   <a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> crossed_faces,unique_faces,edge_faces;
<a name="l00368"></a>00368   <a class="code" href="classNice.html#0565c5314ebb9a3f175fc3a91c5a68da">collectNiceFaces</a>(origin,end,unique_faces);
<a name="l00369"></a>00369   <a class="code" href="classNice.html#ef49455dc3544d86d7b73afe8e660586">findIntersectedFaces</a>(origin,end,unique_faces,crossed_faces,edge_faces);
<a name="l00370"></a>00370   <span class="comment">// remove current vertex adjacent faces from crossed_faces</span>
<a name="l00371"></a>00371   <span class="keywordflow">if</span>(crossed_faces.empty()==<span class="keyword">false</span>)
<a name="l00372"></a>00372   {
<a name="l00373"></a>00373     sort(crossed_faces.begin(),crossed_faces.end());
<a name="l00374"></a>00374     <span class="comment">// for each adjacent face</span>
<a name="l00375"></a>00375     <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#8d2bcc70fbd9a2cca7eecb128703e8c7">fp_cit</a> i=v-&gt;<a class="code" href="classVertex.html#7ebc259c68c71408ecc67662d64e9ec0">begin</a>();i!=v-&gt;<a class="code" href="classVertex.html#4bb81e4284f35a668f19495419a23abb">end</a>();i++)
<a name="l00376"></a>00376     {
<a name="l00377"></a>00377       std::pair&lt;fp_it,fp_it&gt; j; 
<a name="l00378"></a>00378       j=equal_range(crossed_faces.begin(),crossed_faces.end(),*i);
<a name="l00379"></a>00379       <span class="comment">// if adjacent face is found in crossed_faces, then remove from crossed_faces</span>
<a name="l00380"></a>00380       <span class="keywordflow">if</span>(j.first!=j.second){crossed_faces.erase(j.first);}
<a name="l00381"></a>00381     }
<a name="l00382"></a>00382   }
<a name="l00383"></a>00383   <span class="comment">// remove current vertex adjacent faces from edge_faces</span>
<a name="l00384"></a>00384   <span class="keywordflow">if</span>(edge_faces.empty()==<span class="keyword">false</span>)
<a name="l00385"></a>00385   {
<a name="l00386"></a>00386     sort(edge_faces.begin(),edge_faces.end());
<a name="l00387"></a>00387     <span class="comment">// for each adjacent face</span>
<a name="l00388"></a>00388     <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#8d2bcc70fbd9a2cca7eecb128703e8c7">fp_cit</a> i=v-&gt;<a class="code" href="classVertex.html#7ebc259c68c71408ecc67662d64e9ec0">begin</a>();i!=v-&gt;<a class="code" href="classVertex.html#4bb81e4284f35a668f19495419a23abb">end</a>();i++)
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390       std::pair&lt;fp_it,fp_it&gt; j; 
<a name="l00391"></a>00391       j=equal_range(edge_faces.begin(),edge_faces.end(),*i);
<a name="l00392"></a>00392       <span class="comment">// if adjacent face is found in edge_faces, then remove from edge_faces</span>
<a name="l00393"></a>00393       <span class="keywordflow">if</span>(j.first!=j.second){edge_faces.erase(j.first);}
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395   }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="keywordflow">if</span>(edge_faces.empty()==<span class="keyword">false</span>){<span class="keywordflow">return</span> <span class="keyword">false</span>;}
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   <a class="code" href="classNice.html#bb4911d8fc3c85395c8884ab16381b91">findOddMeshes</a>(crossed_faces,edge_faces,c);
<a name="l00400"></a>00400   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00401"></a>00401 }
<a name="l00402"></a>00402 
<a name="l00403"></a><a class="code" href="classNice.html#429be11b18100852c7c6bbeffcb5e296">00403</a> <span class="keywordtype">bool</span> <a class="code" href="classNice.html#429be11b18100852c7c6bbeffcb5e296">Nice::findCrossedObjects2</a> (<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; origin,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; end,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;c)<span class="keyword"> const</span>
<a name="l00404"></a>00404 <span class="keyword"></span>{
<a name="l00405"></a>00405   <span class="comment">// find and return crossed objects between pN and extracellular point</span>
<a name="l00406"></a>00406   <a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> crossed_faces,unique_faces,edge_faces;
<a name="l00407"></a>00407   <a class="code" href="classNice.html#0565c5314ebb9a3f175fc3a91c5a68da">collectNiceFaces</a>(origin,end,unique_faces);
<a name="l00408"></a>00408   <a class="code" href="classNice.html#ef49455dc3544d86d7b73afe8e660586">findIntersectedFaces</a>(origin,end,unique_faces,crossed_faces,edge_faces);
<a name="l00409"></a>00409   <span class="keywordflow">if</span>(edge_faces.empty()==<span class="keyword">false</span>){<span class="keywordflow">return</span> <span class="keyword">false</span>;}
<a name="l00410"></a>00410   <span class="keywordflow">if</span>( (edge_faces.size()%2)==1 )
<a name="l00411"></a>00411   {     
<a name="l00412"></a>00412     cout.precision(12);
<a name="l00413"></a>00413     cout &lt;&lt; <span class="stringliteral">"\n\nError: how can # edge_faces be odd?\n"</span>
<a name="l00414"></a>00414           &lt;&lt; <span class="stringliteral">"Nice::findCrossedObjects2: "</span>
<a name="l00415"></a>00415           &lt;&lt; <span class="stringliteral">"origin ["</span>
<a name="l00416"></a>00416           &lt;&lt; origin[0] &lt;&lt; <span class="stringliteral">" "</span>
<a name="l00417"></a>00417           &lt;&lt; origin[1] &lt;&lt; <span class="stringliteral">" "</span>
<a name="l00418"></a>00418           &lt;&lt; origin[2] &lt;&lt; <span class="stringliteral">"], end ["</span>
<a name="l00419"></a>00419           &lt;&lt; end[0] &lt;&lt; <span class="stringliteral">" "</span>
<a name="l00420"></a>00420           &lt;&lt; end[1] &lt;&lt; <span class="stringliteral">" "</span>
<a name="l00421"></a>00421           &lt;&lt; end[2] &lt;&lt; <span class="stringliteral">"]\n"</span>;
<a name="l00422"></a>00422     cout &lt;&lt; <span class="stringliteral">"Nice::findCrossed2: edge_faces:\n"</span>;
<a name="l00423"></a>00423     <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> i=edge_faces.begin();i!=edge_faces.end();i++)
<a name="l00424"></a>00424     {
<a name="l00425"></a>00425       (*i)-&gt;print(std::cout);
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427     cout &lt;&lt; endl;
<a name="l00428"></a>00428     cout &lt;&lt; <span class="stringliteral">"Nice::findCrossed2: crossed_faces:\n"</span>;
<a name="l00429"></a>00429     <span class="keywordflow">for</span>(<a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> i=crossed_faces.begin();i!=crossed_faces.end();i++)
<a name="l00430"></a>00430     {
<a name="l00431"></a>00431       (*i)-&gt;print(std::cout);
<a name="l00432"></a>00432       cout &lt;&lt; endl;
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434     cout &lt;&lt; endl;
<a name="l00435"></a>00435     exit(0);
<a name="l00436"></a>00436   }
<a name="l00437"></a>00437   <a class="code" href="classNice.html#bb4911d8fc3c85395c8884ab16381b91">findOddMeshes</a>(crossed_faces,edge_faces,c);
<a name="l00438"></a>00438   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 
<a name="l00441"></a><a class="code" href="classNice.html#0ee3dac4558ae253f888e3758ca7ef1d">00441</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#0ee3dac4558ae253f888e3758ca7ef1d">Nice::getExtraRay</a> (<a class="code" href="classVertex.html">Vertex</a> <span class="keyword">const</span> * <span class="keyword">const</span> v,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> &amp; origin,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> &amp; end,<span class="keyword">const</span> <span class="keywordtype">int</span> index)<span class="keyword"> const</span>
<a name="l00442"></a>00442 <span class="keyword"></span>{
<a name="l00443"></a>00443   <span class="comment">// get normal info</span>
<a name="l00444"></a>00444   <span class="comment">//double n[3];</span>
<a name="l00445"></a>00445   <a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> n = v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#c562850fda0a0725a6aebbc80ababa20">getNormal</a>();
<a name="l00446"></a>00446   <span class="comment">// compute centroid of first adjacent face</span>
<a name="l00447"></a>00447   <span class="keywordtype">double</span> a = 1.0/3.0;
<a name="l00448"></a>00448   <span class="keywordtype">double</span> cx = (v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(0)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(0)+
<a name="l00449"></a>00449                v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(1)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(0)+
<a name="l00450"></a>00450                v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(2)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(0))*a;
<a name="l00451"></a>00451   <span class="keywordtype">double</span> cy = (v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(0)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(1)+
<a name="l00452"></a>00452                v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(1)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(1)+
<a name="l00453"></a>00453                v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(2)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(1))*a;
<a name="l00454"></a>00454   <span class="keywordtype">double</span> cz = (v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(0)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(2)+
<a name="l00455"></a>00455                v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(1)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(2)+
<a name="l00456"></a>00456                v-&gt;<a class="code" href="classVertex.html#3ee79c5a1eefd73147d1e7cf8cdd2d14">getAdjacentFace</a>(index)-&gt;<a class="code" href="classFace.html#e41ceba59412e800cf29a1847c5c10bf">getVertex</a>(2)-&gt;<a class="code" href="classVertex.html#e77b7638155ba654b0bee000e8f3eaf2">getCoord</a>(2))*a;
<a name="l00457"></a>00457   <span class="keywordtype">double</span> L = <a class="code" href="controls_8h.html#06b7ca91a439f4edad3563357c58efb3">DOUBLE_EPSILON</a>*<a class="code" href="controls_8h.html#4f159bf187491542eb50806dfdc1110f">SCALE</a>/sqrt( <a class="code" href="misc_8cc.html#aa2064e9e93d580841bffe746925cc8f">dot</a>(n,n) );
<a name="l00458"></a>00458   origin.push_back(cx);
<a name="l00459"></a>00459   origin.push_back(cy);
<a name="l00460"></a>00460   origin.push_back(cz);
<a name="l00461"></a>00461   end.push_back(origin[0]+n[0]*L);
<a name="l00462"></a>00462   end.push_back(origin[1]+n[1]*L);
<a name="l00463"></a>00463   end.push_back(origin[2]+n[2]*L);
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="classNice.html#0565c5314ebb9a3f175fc3a91c5a68da">00466</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#0565c5314ebb9a3f175fc3a91c5a68da">Nice::collectNiceFaces</a> (<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; origin,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; end,<a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> &amp; uf)<span class="keyword"> const</span>
<a name="l00467"></a>00467 <span class="keyword"></span>{
<a name="l00468"></a>00468   <span class="comment">// collect boxes to check</span>
<a name="l00469"></a>00469   <a class="code" href="meshmorph_8h.html#58cf62c0a16eae244b83de08e6cb1ad7">vec_bp</a> b;
<a name="l00470"></a>00470   <a class="code" href="classSpace.html#c0c2e1be07b8a675445b46f575d22a87">Space::instance</a>().<a class="code" href="classSpace.html#b62bb8415270032b864f95c498830575">getBoxesFromPosition</a>(origin,end,b);
<a name="l00471"></a>00471   <span class="comment">// gather faces in boxes</span>
<a name="l00472"></a>00472   <span class="comment">// for each box</span>
<a name="l00473"></a>00473   <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#dbed886c1b2567fd85a7cbfd42af88e3">bp_it</a> i=b.begin();i!=b.end();i++)
<a name="l00474"></a>00474   {
<a name="l00475"></a>00475     <span class="comment">// for each face in box</span>
<a name="l00476"></a>00476     <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#8d2bcc70fbd9a2cca7eecb128703e8c7">fp_cit</a> j=(*i)-&gt;begin();j!=(*i)-&gt;end();j++)
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478       uf.push_back(*j);
<a name="l00479"></a>00479     }
<a name="l00480"></a>00480   }
<a name="l00481"></a>00481   <span class="comment">// keep unique faces</span>
<a name="l00482"></a>00482   sort(uf.begin(),uf.end());
<a name="l00483"></a>00483   uf.assign(uf.begin(),unique(uf.begin(),uf.end()));
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 
<a name="l00486"></a><a class="code" href="classNice.html#ef49455dc3544d86d7b73afe8e660586">00486</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#ef49455dc3544d86d7b73afe8e660586">Nice::findIntersectedFaces</a> (<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; origin,<a class="code" href="meshmorph_8h.html#db0ab3db1ab685e2d2bff657e3e86861">vec_d</a> <span class="keyword">const</span> &amp; end,<a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> &amp;uf,<a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> &amp;cf,<a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> &amp;ef)<span class="keyword"> const</span>
<a name="l00487"></a>00487 <span class="keyword"></span>{
<a name="l00488"></a>00488   <span class="comment">// uf = unique_faces</span>
<a name="l00489"></a>00489   <span class="comment">// cf = crossed_faces</span>
<a name="l00490"></a>00490   <span class="comment">// ff = face_flags</span>
<a name="l00491"></a>00491   <a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> j;
<a name="l00492"></a>00492   <span class="comment">//bool line_flag, poly_flag, poly_edge_flag;</span>
<a name="l00493"></a>00493   <span class="comment">// for each unique polygon</span>
<a name="l00494"></a>00494   <span class="keywordflow">for</span> (j=uf.begin();j!=uf.end();j++)
<a name="l00495"></a>00495   {
<a name="l00496"></a>00496     <span class="comment">//checkLineFaceInt(*j,origin,end,line_flag,poly_flag,poly_edge_flag,false);</span>
<a name="l00497"></a>00497     <a class="code" href="structresult.html">result</a> r = <a class="code" href="misc_8cc.html#2103a6d3f2d61e3c53ae964e0b866798">checkLineFaceInt</a>(*j,origin,end,<span class="keyword">false</span>);
<a name="l00498"></a>00498     <span class="comment">// does point intersect polygon</span>
<a name="l00499"></a>00499     <span class="keywordflow">if</span> (r.line_flag==<span class="keyword">true</span>)
<a name="l00500"></a>00500     {
<a name="l00501"></a>00501       <span class="keywordflow">if</span> (r.poly_edge_flag==<span class="keyword">true</span>)
<a name="l00502"></a>00502       {
<a name="l00503"></a>00503         <span class="comment">// add polygon_index to edge array</span>
<a name="l00504"></a>00504         ef.push_back(*j);
<a name="l00505"></a>00505       }
<a name="l00506"></a>00506       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r.poly_flag==<span class="keyword">true</span>)
<a name="l00507"></a>00507       {
<a name="l00508"></a>00508         <span class="comment">// add polygon_index to crossed array</span>
<a name="l00509"></a>00509         cf.push_back(*j);
<a name="l00510"></a>00510       }
<a name="l00511"></a>00511     }
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00515"></a><a class="code" href="classNice.html#bb4911d8fc3c85395c8884ab16381b91">00515</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#bb4911d8fc3c85395c8884ab16381b91">Nice::findOddMeshes</a> (<a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> &amp;cf,<a class="code" href="meshmorph_8h.html#1f34905de522641c355a51fe9e3f1149">vec_fp</a> &amp;ef,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;tmp)<span class="keyword"> const</span>
<a name="l00516"></a>00516 <span class="keyword"></span>{
<a name="l00517"></a>00517   <span class="comment">// find mesh objects crossed an odd number of times by ray</span>
<a name="l00518"></a>00518 
<a name="l00519"></a>00519   <a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> ol; <span class="comment">// object list</span>
<a name="l00520"></a>00520 
<a name="l00521"></a>00521   <span class="comment">// for each edge crossed face</span>
<a name="l00522"></a>00522   <span class="keywordflow">if</span>(ef.empty()==<span class="keyword">false</span>)
<a name="l00523"></a>00523   {
<a name="l00524"></a>00524     <a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> ee;
<a name="l00525"></a>00525     <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> i=ef.begin();i!=ef.end();i++)
<a name="l00526"></a>00526     {
<a name="l00527"></a>00527       ee.push_back(const_cast&lt;Object*&gt;((*i)-&gt;getVertex(0)-&gt;getObject()));
<a name="l00528"></a>00528     }
<a name="l00529"></a>00529     <a class="code" href="classNice.html#804d33561b81d302f4ef7af21005a61e">findEvenObjects</a>(ee,ol);
<a name="l00530"></a>00530   }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532   <span class="comment">// for each crossed face</span>
<a name="l00533"></a>00533   <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#c65901c49115edae93d689df5a5e2078">fp_it</a> i=cf.begin();i!=cf.end();i++)
<a name="l00534"></a>00534   {
<a name="l00535"></a>00535     ol.push_back(const_cast&lt;Object*&gt;((*i)-&gt;getVertex(0)-&gt;getObject()));
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537   <a class="code" href="classNice.html#0ebe9ba0e93a7b97fd324914af605b4d">findOddObjects</a>(ol,tmp);
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a><a class="code" href="classNice.html#0ebe9ba0e93a7b97fd324914af605b4d">00540</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#0ebe9ba0e93a7b97fd324914af605b4d">Nice::findOddObjects</a> (<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;ol,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;odd)<span class="keyword"> const</span>
<a name="l00541"></a>00541 <span class="keyword"></span>{
<a name="l00542"></a>00542   <span class="comment">// sort object list</span>
<a name="l00543"></a>00543   sort(ol.begin(),ol.end());
<a name="l00544"></a>00544 
<a name="l00545"></a>00545   odd.clear();
<a name="l00546"></a>00546   <span class="keywordtype">int</span> count=ol.size();
<a name="l00547"></a>00547   <span class="keywordtype">int</span> k=0;
<a name="l00548"></a>00548   <span class="comment">// while more Object*s to process</span>
<a name="l00549"></a>00549   <span class="keywordflow">while</span> (k&lt;count)
<a name="l00550"></a>00550   {
<a name="l00551"></a>00551     <span class="comment">// if not on last Object*</span>
<a name="l00552"></a>00552     <span class="keywordflow">if</span> (k+1!=count)
<a name="l00553"></a>00553     {
<a name="l00554"></a>00554       <span class="comment">// skip identical pairs of object indices</span>
<a name="l00555"></a>00555       <span class="keywordflow">if</span> (ol[k]==ol[k+1]) {k++;k++;}
<a name="l00556"></a>00556       <span class="comment">// odd object</span>
<a name="l00557"></a>00557       <span class="keywordflow">else</span> {
<a name="l00558"></a>00558         odd.push_back( ol[k]);
<a name="l00559"></a>00559         k++;
<a name="l00560"></a>00560       }
<a name="l00561"></a>00561     }
<a name="l00562"></a>00562     <span class="keywordflow">else</span>
<a name="l00563"></a>00563     { <span class="comment">// add remaining object to odd object list</span>
<a name="l00564"></a>00564       odd.push_back( ol[k]);
<a name="l00565"></a>00565       k++;
<a name="l00566"></a>00566     }
<a name="l00567"></a>00567   }
<a name="l00568"></a>00568 }
<a name="l00569"></a>00569 
<a name="l00570"></a><a class="code" href="classNice.html#804d33561b81d302f4ef7af21005a61e">00570</a> <span class="keywordtype">void</span> <a class="code" href="classNice.html#804d33561b81d302f4ef7af21005a61e">Nice::findEvenObjects</a> (<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;ol,<a class="code" href="meshmorph_8h.html#adc452f798a41d587a6568b510b6f27c">vec_op</a> &amp;even)<span class="keyword"> const</span>
<a name="l00571"></a>00571 <span class="keyword"></span>{
<a name="l00572"></a>00572   <span class="comment">// sort object list</span>
<a name="l00573"></a>00573   sort(ol.begin(),ol.end());
<a name="l00574"></a>00574 
<a name="l00575"></a>00575   even.clear();
<a name="l00576"></a>00576   <span class="keywordtype">int</span> count=ol.size();
<a name="l00577"></a>00577   <span class="keywordtype">int</span> k=0;
<a name="l00578"></a>00578   <span class="comment">// while more Object*s to process</span>
<a name="l00579"></a>00579   <span class="keywordflow">while</span> (k&lt;count)
<a name="l00580"></a>00580   {
<a name="l00581"></a>00581     <span class="comment">// if not on last Object*</span>
<a name="l00582"></a>00582     <span class="keywordflow">if</span> (k+1!=count)
<a name="l00583"></a>00583     {
<a name="l00584"></a>00584       <span class="comment">// skip identical pairs of object indices</span>
<a name="l00585"></a>00585       <span class="keywordflow">if</span> (ol[k]==ol[k+1])
<a name="l00586"></a>00586       {
<a name="l00587"></a>00587         even.push_back( ol[k]);
<a name="l00588"></a>00588         k++;k++;
<a name="l00589"></a>00589       }
<a name="l00590"></a>00590       <span class="comment">// odd object</span>
<a name="l00591"></a>00591       <span class="keywordflow">else</span>
<a name="l00592"></a>00592       {
<a name="l00593"></a>00593         even.push_back( ol[k]);
<a name="l00594"></a>00594         k++;
<a name="l00595"></a>00595         cout &lt;&lt; <span class="stringliteral">"\n\nNice::findEvenObjects: "</span>
<a name="l00596"></a>00596               &lt;&lt; <span class="stringliteral">"Weird. Was expecting only even numbers of edge_faces.\n"</span>;
<a name="l00597"></a>00597       }
<a name="l00598"></a>00598     }
<a name="l00599"></a>00599     <span class="keywordflow">else</span>
<a name="l00600"></a>00600     { <span class="comment">// add remaining object to even object list</span>
<a name="l00601"></a>00601       even.push_back( ol[k]);
<a name="l00602"></a>00602       cout &lt;&lt; <span class="stringliteral">"\n\nNice::findEvenObjects: "</span>
<a name="l00603"></a>00603             &lt;&lt; <span class="stringliteral">"Weird. Was expecting only even numbers of edge_faces.\n"</span>;
<a name="l00604"></a>00604       k++;
<a name="l00605"></a>00605     }
<a name="l00606"></a>00606   }
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a><a class="code" href="classNice.html#240dbc4371a3b6931b38dda59bd827a0">00609</a> <span class="keywordtype">int</span> <a class="code" href="classNice.html#240dbc4371a3b6931b38dda59bd827a0">Nice::getNonniceCount</a> (<span class="keywordtype">bool</span> self_switch)
<a name="l00610"></a>00610 {
<a name="l00611"></a>00611   <span class="comment">// if self_switch == true</span>
<a name="l00612"></a>00612   <span class="comment">// then only count self intersections</span>
<a name="l00613"></a>00613   <span class="comment">// else count all intersections</span>
<a name="l00614"></a>00614   <span class="keywordtype">int</span> count = 0;
<a name="l00615"></a>00615   <span class="comment">// for each element of nice</span>
<a name="l00616"></a>00616   <span class="keywordflow">for</span> (<a class="code" href="meshmorph_8h.html#8bb21ea8b96f25d850160ffd28bea2bb">vhm_it</a> j=nice.begin();j!=nice.end();j++)
<a name="l00617"></a>00617   {
<a name="l00618"></a>00618     assert( ((*j).second&gt;0) &amp;&amp; ((*j).second&lt;3) ); <span class="comment">// if zero then should have been removed</span>
<a name="l00619"></a>00619     <span class="keywordflow">if</span> (self_switch==<span class="keyword">true</span>)
<a name="l00620"></a>00620     {
<a name="l00621"></a>00621       <span class="keywordflow">if</span>((*j).second==2)
<a name="l00622"></a>00622       {
<a name="l00623"></a>00623         count++;
<a name="l00624"></a>00624       }
<a name="l00625"></a>00625     }
<a name="l00626"></a>00626     <span class="keywordflow">else</span>
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628       count++;
<a name="l00629"></a>00629     }
<a name="l00630"></a>00630   }
<a name="l00631"></a>00631   <span class="keywordflow">return</span> count;
<a name="l00632"></a>00632 }
<a name="l00633"></a>00633 
<a name="l00634"></a><a class="code" href="classNice.html#bfe44fa4a6225393c93eed8c128af13c">00634</a> <a class="code" href="meshmorph_8h.html#37680d6b8f28499a1aee927e43cb33c1">vhm_cit</a> <a class="code" href="classNice.html#bfe44fa4a6225393c93eed8c128af13c">Nice::beginNice</a> (<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00635"></a>00635 <span class="keyword"></span>{
<a name="l00636"></a>00636   <span class="keywordflow">return</span> nice.begin();
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a><a class="code" href="classNice.html#400a9465e49d8fcf1339d28eadc2fd1e">00639</a> <a class="code" href="meshmorph_8h.html#37680d6b8f28499a1aee927e43cb33c1">vhm_cit</a> <a class="code" href="classNice.html#400a9465e49d8fcf1339d28eadc2fd1e">Nice::endNice</a> (<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00640"></a>00640 <span class="keyword"></span>{
<a name="l00641"></a>00641   <span class="keywordflow">return</span> nice.end();
<a name="l00642"></a>00642 }
<a name="l00643"></a>00643 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Jul 18 19:43:40 2008 for meshmorph by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
